<!-- uwu -->
<style>
  .center {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
  }
</style>
<meta charset="UTF-8" />
<head>
  <title>Roguelineage - Abrahampo1</title>
</head>
<h1 style="text-align: center">Siguiente spawn de ores en:</h1>
<div class="center">
  <h2 style="text-align: center" id="time"></h2>
  <button id="sync" onclick="sinc()">Sincronizar!</button>
</div>
<br /><br />
<p style="text-align: center">
  Esta mierda ha sido programada por Abraham (abrahampo1) de la house Frozono
</p>
<br />
<h2>Tutorial</h2>
<hr />
<p>
  Haz click en "Sincronizar!" cuando veas aparecer los minerales, a partir de
  ese momento la página estará sincronizada con tu servidor y podras saber la
  hora exacta de spawn de los ores en todo el servidor. Para reiniciar el
  temporizador, reinicia la página.
</p>

<hr />
<h2>Ajustes</h2>
<label for="sonido">Aviso Sonoro</label><br />
<select name="sonido" id="sonido">
  <option value="https://www.myinstants.com/media/sounds/zeldaitem.swf.mp3">
    Sonido Zelda
  </option>
  <option value="avisos/avisomujer.mp3">TTS Mujer</option>
</select>
<button onclick="testsound()">Probar Sonido</button>
<br /><br />
<label for="audio_src">URL sonido personalizado</label>
<br />
<input type="text" name="audio_src" id="audio_src" />
<button onclick="testsoundcustom()">Probar Sonido</button>
<br />
<p id="infosound"></p>
<br />
<p id="minuto"></p>
<script>
  var sonidos = document.getElementById("sonido");
  var aviso = sonidos.options[sonidos.selectedIndex].value;
  function testsound() {
    var sonidos = document.getElementById("sonido");
    aviso = sonidos.options[sonidos.selectedIndex].value;
    var sound = new Audio(aviso);
    sound.play();
  };
  function testsoundcustom() {
    aviso = document.getElementById("audio_src").value;
    var sound = new Audio(aviso);
    sound.play();
  }
  var empezar = false;
  var minutoaponer;
  function sinc() {
    var myobj = document.getElementById("sync");
    myobj.remove();
    (function () {
      var start = new Date();
      var minuto = new Date();
      var minutoexacto = minuto.getMinutes();
      var horaactual = minuto.getHours();
      var segundos = minuto.getSeconds();
      if (minutoexacto >= 50) {
        minutoaponer = minutoexacto % 10;
        minutoaponer = pad(minutoaponer);
        horaactual++;
      } else {
        minutoaponer = minutoexacto + 10;
      }
      if (segundos < 10) {
        segundos = pad(segundos);
      }
      document.getElementById("minuto").innerHTML =
        "Hora exacta de spawn: " +
        horaactual +
        ":" +
        minutoaponer +
        ":" +
        segundos;
      start.setHours(horaactual, minutoaponer, segundos);
      function pad(num) {
        return ("0" + parseInt(num)).substr(-2);
      }
      function tick() {
        var now = new Date();
        var remain = (start - now) / 1000;
        var hh = pad((remain / 60 / 60) % 60);
        var mm = pad((remain / 60) % 60);
        var ss = pad(remain % 60);
        document.getElementById("time").innerHTML = mm + ":" + ss;

        if (mm == "00" && ss == "00") {
          var sound = new Audio(aviso);
          sound.play();
          var minuto = new Date();
          var segundos = minuto.getSeconds();
          if (segundos < 10) {
            segundos = pad(segundos);
          }
          var minutoexacto = minuto.getMinutes();
          var horaactual = minuto.getHours();
          if (minutoexacto >= 50) {
            minutoaponer = minutoexacto % 10;
            minutoaponer = pad(minutoaponer);
            horaactual++;
          } else {
            minutoaponer = minutoexacto + 10;
          }
          start.setHours(horaactual, minutoaponer, segundos);
          document.getElementById("minuto").innerHTML =
            "Hora exacta de spawn: " +
            horaactual +
            ":" +
            minutoaponer +
            ":" +
            segundos;
        }
        setTimeout(tick, 1000);
      }

      document.addEventListener("DOMContentLoaded", tick);
      tick();
    })();
  }
</script>
